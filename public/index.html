<!DOCTYPE html>
<html>
    <head>
        <title>Kalia Hameiri - IMD3901B A3 - WebVR Rubic's Cube</title>
        <script src="/js/aframe.min.js"></script> <!-- https://github.com/aframevr/aframe -->
    </head>
    <body>
        <a-scene shadow="type:basic;">
            <!-- Setting up camera and curser-->
            <a-entity position ="0 0 0" camera look-controls wasd-controls>
                <a-entity cursor ="fuse:true; fuseTimeOut:1000;rayOrigin:mouse;"
                    position="0 0 -1">                
                </a-entity>
            </a-entity>
            
            <!--Loading planes--> 
            <!--Red faces--> 
            <a-entity class="F1 C2 R2">
                <a-plane id="cubel1" position="0 0 -2" width = "0.95" height="0.95" rotation = "0 0 0"  color="#FF0000" ></a-plane>
            </a-entity>
            <a-entity class="F1 C2 R3">
                <a-plane  id="cubel2" position="0 1 -2" width = "0.95" height="0.95" rotation = "0 0 0"  color="#FF0000" ></a-plane>
            </a-entity>
            <a-entity class="F1 C2 R1"> 
                <a-plane  id="cubel3" position="0 -1 -2" width = "0.95" height="0.95" rotation = "0 0 0"  color="#FF0000" ></a-plane>
            </a-entity>
            <a-entity class="F1 C3 R2">
                <a-plane  id="cubel4" position="1 0 -2" width = "0.95" height="0.95" rotation = "0 0 0"  color="#FF0000" ></a-plane>
            </a-entity>
            <a-entity class="F1 C3 R3">  
                <a-plane  id="cubel5" position="1 1 -2" width = "0.95" height="0.95" rotation = "0 0 0"  color="#FF0000" ></a-plane>
            </a-entity>
            <a-entity class="F1 C3 R1">
                <a-plane  id="cubel6" position="1 -1 -2" width = "0.95" height="0.95" rotation = "0 0 0"  color="#FF0000" ></a-plane>
            </a-entity>
                    
            <a-entity class="F1 C1 R2">
                <a-plane  id="cubel7" position="-1 0 -2" width = "0.95" height="0.95" rotation = "0 0 0"  color="#FF0000" ></a-plane>
            </a-entity >
            <a-entity class="F1 C1 R3">
                <a-plane  id="cubel8" position="-1 1 -2" width = "0.95" height="0.95" rotation = "0 0 0"  color="#FF0000" ></a-plane>
            </a-entity >
            <a-entity class="F1 C1 R1">
                <a-plane  id="cubel9" position="-1 -1 -2" width = "0.95" height="0.95" rotation = "0 0 0"  color="#FF0000" ></a-plane>
            </a-entity>
                
                
            <!--Blue faces--> 
            <a-entity class="F2 C5 R2">
                <a-plane  id="cubel10" position="-2 0 0" width = "0.95" height="0.95" rotation = "0 90 0"  color="#0000ff" ></a-plane>
            </a-entity>
            <a-entity class="F2 C5 R3"> 
                <a-plane  id="cubel11" position="-2 1 0" width = "0.95" height="0.95" rotation = "0 90 0"  color="#0000ff"></a-plane>
            </a-entity>
            <a-entity class="F2 C5 R1"> 
                <a-plane  id="cubel12" position="-2 -1 0" width = "0.95" height="0.95" rotation = "0 90 0"  color="#0000ff"></a-plane>
            </a-entity>

            <a-entity class="F2 C6 R2">
                <a-plane  id="cubel13" position="-2 0 1" width = "0.95" height="0.95" rotation = "0 90 0"  color="#0000ff"></a-plane> 
            </a-entity>  
            <a-entity class="F2 C6 R3">
                <a-plane  id="cubel14" position="-2 1 1" width = "0.95" height="0.95" rotation = "0 90 0"  color="#0000ff"></a-plane>
            </a-entity>
            <a-entity class="F2 C6 R1">
                <a-plane  id="cubel15" position="-2 -1 1" width = "0.95" height="0.95" rotation = "0 90 0"  color="#0000ff" ></a-plane>
            </a-entity>
                
            <a-entity class="F2 C4 R2">
                <a-plane  id="cubel16" position="-2 0 -1" width = "0.95" height="0.95" rotation = "0 90 0"  color="#0000ff"></a-plane>
            </a-entity>
            <a-entity class="F2 C4 R3">
                <a-plane id="cubel17" position="-2 1 -1" width = "0.95" height="0.95" rotation = "0 90 0"  color="#0000ff"></a-plane>
            </a-entity>  
            <a-entity class="F2 C4 R1">
                <a-plane  id="cubel18" position="-2 -1 -1" width = "0.95" height="0.95" rotation = "0 90 0"  color="#0000ff"></a-plane>
            </a-entity>
            
            <!--Yellow faces--> 
            <a-entity class="F5 C2 C5">
                <a-plane  id="cubel37" position="0 2 0" width = "0.95" height="0.95" rotation = "90 0 0"  color="#f2ff00" ></a-plane>
            </a-entity>
            <a-entity class="F5 C2 C6">
                <a-plane  id="cubel38" position="0 2 1" width = "0.95" height="0.95" rotation = "90 0 0"  color="#f2ff00" ></a-plane>         
            </a-entity>
            <a-entity class="F5 C2 C4">
                <a-plane  id="cubel39" position="0 2 -1" width = "0.95" height="0.95" rotation = "90 0 0"  color="#f2ff00" ></a-plane>     
            </a-entity>
                
            <a-entity class="F5 C3 C5">
                <a-plane  id="cubel40" position="1 2 0" width = "0.95" height="0.95" rotation = "90 0 0"  color="#f2ff00" ></a-plane>   
            </a-entity>
            <a-entity class="F5 C3 C6">
                <a-plane  id="cubel41" position="1 2 1" width = "0.95" height="0.95" rotation = "90 0 0"  color="#f2ff00" ></a-plane>    
            </a-entity>
            <a-entity class="F5 C3 C4">
                <a-plane  id="cubel42" position="1 2 -1" width = "0.95" height="0.95" rotation = "90 0 0"  color="#f2ff00" ></a-plane>   
            </a-entity>
                
            <a-entity class="F5 C1 C5">
                <a-plane  id="cubel43" position="-1 2 0" width = "0.95" height="0.95" rotation = "90 0 0"  color="#f2ff00" ></a-plane>    
            </a-entity>
            <a-entity class="F5 C1 C6">
                <a-plane  id="cubel44" position="-1 2 1" width = "0.95" height="0.95" rotation = "90 0 0"  color="#f2ff00" ></a-plane>       
            </a-entity>
            <a-entity class="F5 C1 C4">
                <a-plane  id="cubel45" position="-1 2 -1" width = "0.95" height="0.95" rotation = "90 0 0"  color="#f2ff00" ></a-plane>        
            </a-entity>
                
            <!--Green faces#00ff00-->
            <a-entity class="F3 C5 R2">
                <a-plane  id="cubel19" position="2 0 0" width = "0.95" height="0.95" rotation = "0 -90 0"  color="#00ff00" ></a-plane>
            </a-entity>
            <a-entity class="F3 C5 R3">
                <a-plane  id="cubel20" position="2 1 0" width = "0.95" height="0.95" rotation = "0 -90 0"  color="#00ff00"></a-plane>
            </a-entity>
            <a-entity class="F3 C5 R1">
                <a-plane  id="cubel21" position="2 -1 0" width = "0.95" height="0.95" rotation = "0 -90 0"  color="#00ff00"></a-plane>
            </a-entity>

            <a-entity class="F3 C6 R2">
                <a-plane  id="cubel22" position="2 0 1" width = "0.95" height="0.95" rotation = "0 -90 0"  color="#00ff00"></a-plane>
            </a-entity>
            <a-entity class="F3 C6 R3">
                <a-plane  id="cubel23" position="2 1 1" width = "0.95" height="0.95" rotation = "0 -90 0"  color="#00ff00"></a-plane>
            </a-entity>
            <a-entity class="F3 C6 R1">
                <a-plane  id="cubel24" position="2 -1 1" width = "0.95" height="0.95" rotation = "0 -90 0"  color="#00ff00" ></a-plane>
            </a-entity>
                   
            <a-entity class="F3 C4 R2">
                <a-plane  id="cubel25" position="2 0 -1" width = "0.95" height="0.95" rotation = "0 -90 0"  color="#00ff00"></a-plane>
            </a-entity>
            <a-entity class="F3 C4 R3">
                <a-plane  id="cubel26" position="2 1 -1" width = "0.95" height="0.95" rotation = "0 -90 0"  color="#00ff00"></a-plane>
            </a-entity>
            <a-entity class="F3 C4 R1">
                <a-plane  id="cubel27" position="2 -1 -1" width = "0.95" height="0.95" rotation = "0 -90 0"  color="#00ff00"></a-plane>
            </a-entity>
                
            <!--Orange faces--> 
            <a-entity class="F4 C2 R2">
                <a-plane  id="cubel28" position="0 0 2" width = "0.95" height="0.95" rotation = "0 -180 0"  color="#ff7700" ></a-plane>
            </a-entity>
            <a-entity class="F4 C2 R3">
                <a-plane  id="cubel29" position="0 1 2" width = "0.95" height="0.95" rotation = "0 -180 0"  color="#ff7700" ></a-plane>
            </a-entity>
            <a-entity class="F4 C2 R1">
                <a-plane  id="cubel30" position="0 -1 2" width = "0.95" height="0.95" rotation = "0 -180 0"  color="#ff7700" ></a-plane>
            </a-entity>

            <a-entity class="F4 C3 R2" >
                <a-plane  id="cubel31" position="1 0 2" width = "0.95" height="0.95" rotation = "0 -180 0"  color="#ff7700" ></a-plane>
            </a-entity >
            <a-entity class="F4 C3 R3">
                <a-plane  id="cubel32" position="1 1 2" width = "0.95" height="0.95" rotation = "0 -180 0"  color="#ff7700" ></a-plane>     
            </a-entity>
            <a-entity class="F4 C3 R1">
                <a-plane  id="cubel33" position="1 -1 2" width = "0.95" height="0.95" rotation = "0 -180 0"  color="#ff7700" ></a-plane>    
            </a-entity>

            <a-entity class="F4 C1 R2" >
                <a-plane  id="cubel34" position="-1 0 2" width = "0.95" height="0.95" rotation = "0 -180 0"  color="#ff7700" ></a-plane>
            </a-entity >
            <a-entity class="F4 C1 R3">
                <a-plane  id="cubel35" position="-1 1 2" width = "0.95" height="0.95" rotation = "0 -180 0"  color="#ff7700" ></a-plane>     
            </a-entity>
            <a-entity class="F4 C1 R1">
                <a-plane  id="cubel36" position="-1 -1 2" width = "0.95" height="0.95" rotation = "0 -180 0"  color="#ff7700" ></a-plane>      
            </a-entity>
                
        
            
                      
            <!--White faces--> 
            <a-entity class="F6 C2 C5">
                <a-plane  id="cubel46" position="0 -2 0" width = "0.95" height="0.95" rotation = "-90 0 0"  color="#ffffff" ></a-plane>  
            </a-entity>
            <a-entity class="F6 C2 C6">
                <a-plane  id="cubel47" position="0 -2 1" width = "0.95" height="0.95" rotation = "-90 0 0"  color="#ffffff" ></a-plane>       
            </a-entity>
            <a-entity class="F6 C2 C4">
                <a-plane  id="cubel48" position="0 -2 -1" width = "0.95" height="0.95" rotation = "-90 0 0"  color="#ffffff" ></a-plane>        
            </a-entity>
                 
            <a-entity class="F6 C3 C5">
                <a-plane  id="cubel49" position="1 -2 0" width = "0.95" height="0.95" rotation = "-90 0 0"  color="#ffffff" ></a-plane>  
            </a-entity>
            <a-entity class="F6 C3 C6">
                <a-plane  id="cubel50" position="1 -2 1" width = "0.95" height="0.95" rotation = "-90 0 0"  color="#ffffff" ></a-plane>        
            </a-entity>
            <a-entity class="F6 C3 C4">
                <a-plane  id="cubel51" position="1 -2 -1" width = "0.95" height="0.95" rotation = "-90 0 0"  color="#ffffff" ></a-plane>        
            </a-entity>
                  
            <a-entity class="F6 C1 C5">
                <a-plane  id="cubel52" position="-1 -2 0" width = "0.95" height="0.95" rotation = "-90 0 0"  color="#ffffff" ></a-plane>    
            </a-entity>
            <a-entity class="F6 C1 C6">
                <a-plane  id="cubel53" position="-1 -2 1" width = "0.95" height="0.95" rotation = "-90 0 0"  color="#ffffff" ></a-plane>               
            </a-entity>
            <a-entity class="F6 C1 C4">
                <a-plane  id="cubel54" position="-1 -2 -1" width = "0.95" height="0.95" rotation = "-90 0 0"  color="#ffffff" ></a-plane>               
            </a-entity>      
               
                

            <a-sky color = "#000000"></a-sky> 
        </a-scene>    
        <script src='/socket.io/socket.io.js'></script>
        <script>
            //write some socket client code
            let socket = io();
            //built in event
            socket.on('connect',function(data){
                console.log('conneted!');
            });
            //custom event
            socket.on('rotate_column',function(data){
               console.log('column: '+ data.column + " direction: " + data.direction);
               let colCubes = document.querySelectorAll(".C"+data.column); //get reference to cubels in column to be rotated
               let cubeClasses = new Array(colCubes.length);//make empty array of same length to save the class names 
               var i =0;
               colCubes.forEach(function(cubel){//loop through cubeElements
                    //console.log(cubel);
                    //rotate column cubel by cubel
                    if(data.column<4){
                        cubel.object3D.rotation.x += THREE.Math.degToRad(90*data.direction);
                    }
                    else{
                        cubel.object3D.rotation.z += THREE.Math.degToRad(90*data.direction);
                    }
                    cubeClasses[i] = cubel.className;//save class name of cube
                    console.log(cubeClasses[i])    
                    i++;//increase index   
               })
                updateClassName(colCubes,cubeClasses,data.direction);                
            });
            socket.on('rotate_row',function(data){
               console.log('row: '+ data.row + " direction: " + data.direction);
               let rowCubes = document.querySelectorAll(".R"+data.row);
               console.log(rowCubes.length);
               rowCubes.forEach(function(cubel){
                    console.log(cubel.id);
                    cubel.object3D.rotation.y += THREE.Math.degToRad(90*data.direction);
               })
            });

            function updateClassName(cubeList,classNameList,dir){
                var i =0;
                cubeList.forEach(function(cube){
                    console.log('old: '+ cube.className);

                    j = i+(dir*3);//the cube always moves three positions over
                    if(j<0){
                        j+=classNameList.length;//rolls over value to end of array
                    }
                    else if(j>11){
                        j-=classNameList.length;//rolls over value to begining of array
                    
                    }
                    cube.className = classNameList[j]
                    console.log('new: '+ cube.className);
                    i++;
                })
            }
        </script>
    </body>
</html>